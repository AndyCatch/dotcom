(()=>{"use strict";var n=[,(t,e,n)=>{n.r(e),n.d(e,{sequencer:()=>r});var o="ontouchstart"in window||navigator.msMaxTouchPoints;function h(t,e){t=t.match(new RegExp(`.*(?=${e})`));return null===t?"":t.join("")}function g(t,e){t=t.match(new RegExp(`[^${e}]+$`));return null===t?"":t[0]}function d(t){t=t.match(/\d+(?!.*\d)/g);return null===t?"":t[0]}function f(t){console.warn("Can’t parse the file sequence correctly, returning [].\nReason: "+t)}const i=[];class s{constructor(t){if(this.config={canvas:null,list:[],from:"",to:"",step:1,scaleMode:"cover",direction:"x",playMode:"drag",loop:"loop",interval:0,autoLoad:"all",fitFirstImage:!1,showLoadedImages:!1,dragAmount:10,hiDPI:!0,smoothing:!0,...t},""==this.config.from&&""==this.config.to&&0==this.config.list.length)return console.error("Missing filenames."),!1;if(null===this.config.canvas){const t=document.createElement("canvas");document.body.appendChild(t),this.config.canvas=t,this.config.fitFirstImage=!0}this.pointer={x:0,y:0,down:!1},this.current=-1,this.images=[],this.directionSign=/-/.test(this.config.direction)?-1:1,this.lastLoaded=-1,this.pongSign=1,this.ctx=this.config.canvas.getContext("2d"),this.list=0<this.config.list.length?this.config.list:function(e,t,n=1){var i=[],o=d(e);if(""===o)f("the first filename doesn’t contain a number.");else{var s=d(t);if(""===s)f("the last filename doesn’t contain a number.");else{var a=h(e,o),c=g(e,o);if(a!==h(t,s)||c!==g(t,s))f("the base-names of '"+e+"' and '"+t+"' don’t match.");else if(0!=o.charAt(0)&&0!=s.charAt(0)||o.length==s.length){var e=parseInt(o),r=parseInt(s);for(let t=e;t<=r;t+=n)i.push(a+(t+"").padStart(o.length,"0")+c)}else f("wrong number of leading zeros.")}}return i}(this.config.from,this.config.to,this.config.step),this.size(this.ctx.canvas.width,this.ctx.canvas.height),"first"==this.config.autoLoad?c(this.images,[this.list.shift()],a.bind(null,this)):"all"==this.config.autoLoad&&this.load()}load(){this.load=function(){console.log("load() can be called only once.")},c(this.images,this.list,a.bind(null,this),function(t,e){"function"==typeof t.config.queueComplete&&(e.sequencer=t).config.queueComplete(e),"function"==typeof t.queueComplete&&t.queueComplete(e),t.run(),t.config.showLoadedImages||"none"===t.config.playMode||t.drawImage(0)}.bind(null,this))}run(){const i=o?"touchmove":"mousemove",t=o?"touchstart":"mousedown",e=o?"touchend":"mouseup";if("hover"===this.config.playMode)this.ctx.canvas.addEventListener(i,function(t,e){var n=t.images.length,i=t.config.hiDPI?window.devicePixelRatio:1;let o,s,a,c;s=e.touches?(o=e.touches[0].pageX-e.touches[0].target.offsetLeft,e.touches[0].pageY-e.touches[0].target.offsetTop):(o=e.offsetX,e.offsetY),"x"==t.config.direction?(c=t.ctx.canvas.width/i,a=o):"-x"==t.config.direction?(c=t.ctx.canvas.width/i,a=c-o-1):"y"==t.config.direction?(c=t.ctx.canvas.height/i,a=s):"-y"==t.config.direction&&(c=t.ctx.canvas.height/i,a=c-s-1);i=Math.floor(a/c*n),n=n-1;n=i<0?0:n<i?n:i;n!=t.current&&(t.drawImage(n),t.current=n),e.preventDefault()}.bind(null,this));else if("drag"===this.config.playMode)this.ctx.canvas.addEventListener(i,function(o,s){if(o.pointer.down){var a=o.images.length;let t,e,n=(e=s.touches?(t=s.touches[0].pageX-s.touches[0].target.offsetLeft,s.touches[0].pageY-s.touches[0].target.offsetTop):(t=s.offsetX,s.offsetY),0),i=(/x/.test(o.config.direction)?n=(t-o.pointer.x)*o.directionSign:/y/.test(o.config.direction)&&(n=(e-o.pointer.y)*o.directionSign),o.pointer.currentId+Math.floor(n/o.config.dragAmount));i<0?i=a- -i%a:i>a&&(i%=a),i!=o.current&&(o.drawImage(i),o.current=i),s.preventDefault()}}.bind(null,this)),this.ctx.canvas.addEventListener(t,function(t,e){let n,i;i=e.touches?(n=e.touches[0].pageX-e.touches[0].target.offsetLeft,e.touches[0].pageY-e.touches[0].target.offsetTop):(n=e.offsetX,e.offsetY),t.pointer={x:n,y:i,down:!0,currentId:t.current}}.bind(null,this)),document.addEventListener(e,function(t,e){t.pointer.down=!1}.bind(null,this));else if("auto"===this.config.playMode){let n=0;const i=t=>{var e=t-n;e>=this.config.interval&&(this.nextImage(),n=Math.max(t,t-(e-this.config.interval))),requestAnimationFrame(i)};requestAnimationFrame(i)}}nextImage(t){"pong"===(t=t||this.config.loop)?(this.current+=this.pongSign,this.current>=this.images.length-1?(this.pongSign=-1,this.current=this.images.length-1):this.current<=0&&(this.pongSign=1,this.current=0),this.drawImage(this.current)):this.drawImage(++this.current%this.images.length)}drawImage(n){if(!((n=void 0===n?this.current:n)<0||n>=this.images.length)){var i=this.config.hiDPI?window.devicePixelRatio:1,o=this.ctx.canvas.width/i,s=this.ctx.canvas.height/i,a=o/s,n=this.images[n],c=n.width/n.height;let t,e;"cover"==this.config.scaleMode?c<a?(t=o,e=t/c):(e=s,t=e*c):"contain"==this.config.scaleMode?a<c?(t=o,e=t/c):(e=s,t=e*c):(t=n.width,e=n.height);a=o/2-t/2,c=s/2-e/2;this.ctx.save(),this.ctx.scale(i,i),this.ctx.clearRect(0,0,o,s),this.ctx.imageSmoothingEnabled=this.config.smoothing,this.ctx.drawImage(n,0,0,n.width,n.height,Math.floor(a),Math.floor(c),Math.ceil(t),Math.ceil(e)),this.ctx.restore()}}size(t,e){var n=this.config.hiDPI?window.devicePixelRatio:1,i=this.ctx.canvas;i.width=t*n,i.height=e*n,i.style.width=t+"px",i.style.height=e+"px",this.drawImage()}}function a(t,e){e.id>t.lastLoaded&&t.config.showLoadedImages&&(t.drawImage(e.id),t.lastLoaded=e.id),"function"==typeof t.config.imageLoad&&(e.sequencer=t).config.imageLoad(e),"function"==typeof t.imageLoad&&(e.sequencer=t).imageLoad(e),0===e.id&&(t.config.fitFirstImage&&(t.size(e.img.width,e.img.height),t.config.fitFirstImage=!1),t.drawImage(0),t.current=0)}function c(o,s,a,c){var e=Math.min(s.length,4);let r=o.length-1,h=o.length;for(let t=0;t<e;t++)!function e(){if(r>=s.length-1)return;r++;const n=new Image;var i;n.src=s[r],i=r,n.onload=t=>{"function"==typeof a&&a({id:i,img:n,count:++h,total:s.length}),h<s.length&&e(),h==s.length&&"function"==typeof c&&c({total:s.length})},n.onerror=t=>{console.error("Error with: "+s[i])},o.push(n)}()}var r={make:function(t){t=new s(t);return!1!==t&&i.push(t),t},instances:i}}],i={};function o(t){var e=i[t];return void 0!==e||(e=i[t]={exports:{}},n[t](e,e.exports,o)),e.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var t={};{o.r(t),o.d(t,{resizeSequencer:()=>function(t){a.forEach(function(t,e){var n;t&&(n=Math.floor(t.ctx.canvas.parentNode.getBoundingClientRect().width),t.size(n,n))})}});var s=o(1);const e=[],a=[];e.push({from:"https://andycatch.com/proto/wp-content/uploads/2023/08/KIDA01.png",to:"https://andycatch.com/proto/wp-content/uploads/2023/08/KIDA16.png",playMode:"hover",direction:"x",showLoadedImages:!0,scaleMode:"contain"}),window.addEventListener("load",t=>{console.log("Sequencer loaded"),e.forEach(function(t,e){t.canvas=document.querySelector("canvas");var n=s.sequencer.make(t);n.size(t.canvas.parentNode.offsetWidth,t.canvas.parentNode.offsetHeight),a.push(n)})})}})();